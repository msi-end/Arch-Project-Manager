<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/darkMode.css">
  <link rel="stylesheet" href="/css/index.css">
  <link rel="stylesheet" href="/css/responsive.css">
  <link rel="stylesheet" href="sweetalert2.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="../../js/admin/dashboard.module.js"></script>
  <title>Admin | EBAH</title>
</head>

<body>
  <section>
    <%- include('../partials/admin.aside.ejs') %>
      <main data-app-page="default">
        <div class="main-data">
          <%- include('../partials/admin.header.ejs') %>
            <!-- --HEADING-- -->
            <div class="heading">
              <h2>Project Dashboard</h2>
              <p class="title">Find all project details here</p>
            </div>
            <!-- --SUB-HEADING-- -->
            <div class="top-section flex align-center j-between">
              <div class="section-text">
                <h3 class="flex">All Projects</h3>
              </div>
              <div class="searchBox flex align-center">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="search" onclick="SearchFromInput()">
                  <path fill="##000000"
                    d="M21.71,20.29,18,16.61A9,9,0,1,0,16.61,18l3.68,3.68a1,1,0,0,0,1.42,0A1,1,0,0,0,21.71,20.29ZM11,18a7,7,0,1,1,7-7A7,7,0,0,1,11,18Z">
                  </path>
                </svg>
                <input type="text" class="searchQuery" oninput="search()" placeholder="Search for anything...">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="times" class="close"
                  onclick="clearInput()">
                  <path fill="##000000"
                    d="M13.41,12l4.3-4.29a1,1,0,1,0-1.42-1.42L12,10.59,7.71,6.29A1,1,0,0,0,6.29,7.71L10.59,12l-4.3,4.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L12,13.41l4.29,4.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z">
                  </path>
                </svg>
              </div>
            </div>
            <!-- ----------- DATA TABLE----------- -->

            <div class="data-info">
              <table>
                <thead>
                  <tr>
                    <th>Ref No.</th>
                    <th>Client Name</th>
                    <th>Project Name</th>
                    <th>Agreement Date</th>
                    <th>Status</th>
                    <th>Action</th>
                    <th></th>
                  </tr>
                </thead>

                <tbody>
                  <% sortedData?.forEach((pdata)=>{ %>
                    <tr>
                      <td data-dealId="<%= pdata.id %>" id="refid">
                        <%= pdata.reference_no %>
                      </td>
                      <td id="clientId">
                        <%= pdata.deal_name %>
                      </td>
                      <td>
                        <%= pdata.work_name %>
                      </td>
                      <td>
                        <%= pdata.np_deadline ? pdata.np_deadline : "N/A" %>
                      </td>
                      <% let overallStatus=pdata.category.every((el)=>{
                        if(el.cat_mp_status.toLowerCase() === 'completed'){
                        return true;}else{return false;}})%>

                        <td class=""><button class="<%= overallStatus ? 'status success' : 'status warning' %>">
                            <%= overallStatus ? "completed" : "pending" %>
                          </button></td>
                        <td class="flex align-center">
                          <button class="edit" data-dealid="<%= pdata.id %>"
                            onclick="editProject(this, 'normal')">Edit</button>
                          <button class="delete" onclick="DeleteProject(this,<%= pdata.id %>)">Delete</button>
                        </td>
                        <td>
                          <span class="icon">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="angle-double-right">
                              <path fill=""
                                d="M8.46,8.29A1,1,0,1,0,7,9.71L9.34,12,7,14.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0l3-3a1,1,0,0,0,0-1.42Zm8.5,3-3-3a1,1,0,0,0-1.42,1.42L14.84,12l-2.3,2.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0l3-3A1,1,0,0,0,17,11.29Z">
                              </path>
                            </svg>
                          </span>
                        </td>
                    </tr>

                    <% }) %>
                </tbody>

                <%- include('../partials/pagin.ejs') %>
              </table>
            </div>
        </div>

        <!-- --MORE-DATA-- -->
        <div class="more-data hide">
          <% sortedData?.forEach((el)=>{ %>
            <%- include('../partials/nTableData.ejs', {pdata: el }) %>
              <% }) %>
        </div>

        <!-- POPUPS  -->

        <div class="main-popup hide"></div>
        <%- include('../partials/tasks/notification.ejs') %>
          <%- include('../partials/tasks/alert.ejs') %>
      </main>
  </section>


  <!-- JAVASCRIPT -->

  <script src="../../js/admin/index.js"></script>
  <script src="../../js/admin/common.js"></script>
  <script src="../../js/admin/dashboard.render.js"></script>
  <script src="../../js/admin/dashboard.js"></script>
</body>

</html>